var It=Object.defineProperty;var bt=(s,t,n)=>t in s?It(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var R=(s,t,n)=>bt(s,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();const Et="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split("");function Nt(s){const t=[];for(let i in s){const r=s[i].toString(2);let h=8-r.length,a="";for(let u=0;u<h;u++)a="0"+a;t.push(a+r)}let n=t.join(""),e=[];for(let i=0;i<n.length;i+=5){let r=n.substring(i,i+5);if(r.length<5){let a=5-r.length,u="";for(let l=0;l<a;l++)u+="0";r+=u}let h=parseInt(r,2);e.push(Et[h])}if(e.length%8!=0){let i=8-e.length%8;for(let r=0;r<i;r++)e.push("=")}return e.join("")}function St(){const s=Date.now(),t=Math.floor(Math.random()*1e6),n=BigInt(s)*BigInt(1e6)+BigInt(t);return Math.floor(Math.random()*1e4).toString(36)+n.toString(36)}function Ht(s){const t=new Uint8Array(s.length);for(let n=0;n<s.length;n++)t[n]=s.charCodeAt(n);return t}function k(s,t){let n=0,e=0,i=0;for(;;){const r=s[t++];if(i++,n|=(r&127)<<e,(r&128)===0)break;e+=7}return{value:n,length:i}}function ht(s){let t=0;const n=[];for(;t<s.length;){const e=s[t++],i=e>>3,r=e&7;if(i!==1){if(r===0){const{value:c,length:f}=k(s,t);console.warn(`Skipped field ${i} with int value: ${c}`),t+=f}else if(r===2){const{value:c,length:f}=k(s,t);console.warn(`Skipped field ${i} with value len: ${c}`),t+=f+c}else throw new Error(`Unsupported wire type: ${r}`);continue}if(r!==2)throw new Error(`Got fieldNum 1 but have invalid wireType: ${r}`);const{value:h,length:a}=k(s,t);t+=a;const u=s.slice(t,t+h);t+=h;let l=0;const w={};for(w.id=St();l<u.length;){const c=u[l++],f=c>>3,p=c&7;if(p===2){const{value:g,length:m}=k(u,l);l+=m;const y=u.slice(l,l+g);l+=g;const A=new TextDecoder().decode(y);f===1&&(w.secret=Nt(y)),f===2&&(w.name=A),f===3&&(w.issuer=A)}else if(p===0){const{value:g,length:m}=k(u,l);l+=m,f===4&&(w.algorithm=g),f===5&&(w.digits=g===1?6:8),f===6&&(w.type=g),f===7&&(w.counter=g)}}n.push(w)}return n}const Tt=`<div id="setting" class="tab">
    <textarea id="data" rows="10"></textarea>
    <input placeholder="Password" id="setPassword" value="" />
    <button id="btnSave">Save</button>
</div>`;class Lt{constructor(){R(this,"title","Import Accounts");R(this,"content",Tt)}onShow(t){const n=t.body.querySelector("#btnSave"),e=t.body.querySelector("#setPassword"),i=t.body.querySelector("#data");n.addEventListener("click",async()=>{const r=ht(Ht(i.value));await appStorage.addItems(r,e.value).then(()=>location.reload())})}}const Ut=Object.freeze(Object.defineProperty({__proto__:null,default:Lt},Symbol.toStringTag,{value:"Module"})),$=Object.assign({"./dialogs/import.ts":Ut}),K=Object.create(null);for(const s in $){const t=s.match(/\/([^\/]+)\.ts$/);if(!t)continue;const n=t[1],e=$[s].default;K[n]={class:e}}console.log(K);class Ct{constructor(t="custom-dialog",n="dialog-title",e="dialog-body",i="dialog-close"){R(this,"overlay");R(this,"title");R(this,"body");R(this,"closeBtn");this.overlay=document.getElementById(t),this.title=document.getElementById(n),this.body=document.getElementById(e),this.closeBtn=document.getElementById(i),this.closeBtn.addEventListener("click",()=>this.hide()),this.overlay.addEventListener("click",r=>{r.target===this.overlay&&this.hide()})}show(t,n){let e;if(typeof t=="string"){if(!(t in K)){console.error(`Dialog not found: ${t}`);return}K[t].instance||(K[t].instance=new K[t].class),e=K[t].instance}else e=t;this.title.textContent=e.title,this.body.innerHTML="",typeof e.content=="string"?this.body.innerHTML=e.content:this.body.appendChild(e.content),this.overlay.style.display="flex",e.onShow(this,n)}hide(){this.overlay.style.display="none"}}async function Rt(s,t){const n=new TextEncoder().encode(t),e=await crypto.subtle.digest("SHA-256",n),i=crypto.getRandomValues(new Uint8Array(12)),r={name:"AES-GCM",iv:i},h=await crypto.subtle.importKey("raw",e,r,!1,["encrypt"]),a=new TextEncoder().encode(s),u=await crypto.subtle.encrypt(r,h,a),w=Array.from(new Uint8Array(u)).map(p=>String.fromCharCode(p)).join(""),c=btoa(w);return Array.from(i).map(p=>("00"+p.toString(16)).slice(-2)).join("")+c}async function Kt(s,t){const n=new TextEncoder().encode(t),e=await crypto.subtle.digest("SHA-256",n),i=s.slice(0,24).match(/.{2}/g).map(u=>parseInt(u,16)),r={name:"AES-GCM",iv:new Uint8Array(i)},h=await crypto.subtle.importKey("raw",e,r,!1,["decrypt"]),a=atob(s.slice(24));if(a!==null){const u=new Uint8Array(a.match(/[\s\S]/g).map(c=>c.charCodeAt(0))),l=await crypto.subtle.decrypt(r,h,u);return new TextDecoder().decode(l)}return""}class Mt{hasData(){return!!localStorage.data}async addItem(t,n){return this.addItems([t],n)}async addItems(t,n){let e=[];return this.hasData()&&(e=await this.getData(n)),e.push(...t),this.setData(e,n)}setData(t,n){return Rt(JSON.stringify(t),n).then(e=>(localStorage.data=e,!0))}getData(t){return Kt(localStorage.data,t).then(n=>{if(n[0]!="["){let e=atob(n);const i=new Uint8Array(e.length);for(let h=0;h<e.length;h++)i[h]=e.charCodeAt(h);const r=ht(i);return console.warn("Migrating old data to new object",r),this.setData(r,t),r}return JSON.parse(n)})}}var ct=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.HOTP=1]="HOTP",s[s.TOTP=2]="TOTP",s))(ct||{});const ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",at="ARRAYBUFFER not supported by this environment",lt="UINT8ARRAY not supported by this environment";function q(s,t,n,e){let i,r,h;const a=t||[0],u=(n=n||0)>>>3,l=e===-1?3:0;for(i=0;i<s.length;i+=1)h=i+u,r=h>>>2,a.length<=r&&a.push(0),a[r]|=s[i]<<8*(l+e*(h%4));return{value:a,binLen:8*s.length+n}}function B(s,t,n){switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(s){case"HEX":return function(e,i,r){return function(h,a,u,l){let w,c,f,p;if(h.length%2!=0)throw new Error("String of HEX type must be in byte increments");const g=a||[0],m=(u=u||0)>>>3,y=l===-1?3:0;for(w=0;w<h.length;w+=2){if(c=parseInt(h.substr(w,2),16),isNaN(c))throw new Error("String of HEX type contains invalid characters");for(p=(w>>>1)+m,f=p>>>2;g.length<=f;)g.push(0);g[f]|=c<<8*(y+l*(p%4))}return{value:g,binLen:4*h.length+u}}(e,i,r,n)};case"TEXT":return function(e,i,r){return function(h,a,u,l,w){let c,f,p,g,m,y,A,v,E=0;const b=u||[0],N=(l=l||0)>>>3;if(a==="UTF8")for(A=w===-1?3:0,p=0;p<h.length;p+=1)for(c=h.charCodeAt(p),f=[],128>c?f.push(c):2048>c?(f.push(192|c>>>6),f.push(128|63&c)):55296>c||57344<=c?f.push(224|c>>>12,128|c>>>6&63,128|63&c):(p+=1,c=65536+((1023&c)<<10|1023&h.charCodeAt(p)),f.push(240|c>>>18,128|c>>>12&63,128|c>>>6&63,128|63&c)),g=0;g<f.length;g+=1){for(y=E+N,m=y>>>2;b.length<=m;)b.push(0);b[m]|=f[g]<<8*(A+w*(y%4)),E+=1}else for(A=w===-1?2:0,v=a==="UTF16LE"&&w!==1||a!=="UTF16LE"&&w===1,p=0;p<h.length;p+=1){for(c=h.charCodeAt(p),v===!0&&(g=255&c,c=g<<8|c>>>8),y=E+N,m=y>>>2;b.length<=m;)b.push(0);b[m]|=c<<8*(A+w*(y%4)),E+=2}return{value:b,binLen:8*E+l}}(e,t,i,r,n)};case"B64":return function(e,i,r){return function(h,a,u,l){let w,c,f,p,g,m,y,A=0;const v=a||[0],E=(u=u||0)>>>3,b=l===-1?3:0,N=h.indexOf("=");if(h.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(h=h.replace(/=/g,""),N!==-1&&N<h.length)throw new Error("Invalid '=' found in base-64 string");for(c=0;c<h.length;c+=4){for(g=h.substr(c,4),p=0,f=0;f<g.length;f+=1)w=ut.indexOf(g.charAt(f)),p|=w<<18-6*f;for(f=0;f<g.length-1;f+=1){for(y=A+E,m=y>>>2;v.length<=m;)v.push(0);v[m]|=(p>>>16-8*f&255)<<8*(b+l*(y%4)),A+=1}}return{value:v,binLen:8*A+u}}(e,i,r,n)};case"BYTES":return function(e,i,r){return function(h,a,u,l){let w,c,f,p;const g=a||[0],m=(u=u||0)>>>3,y=l===-1?3:0;for(c=0;c<h.length;c+=1)w=h.charCodeAt(c),p=c+m,f=p>>>2,g.length<=f&&g.push(0),g[f]|=w<<8*(y+l*(p%4));return{value:g,binLen:8*h.length+u}}(e,i,r,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(at)}return function(e,i,r){return function(h,a,u,l){return q(new Uint8Array(h),a,u,l)}(e,i,r,n)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(lt)}return function(e,i,r){return q(e,i,r,n)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function V(s,t,n,e){switch(s){case"HEX":return function(i){return function(r,h,a,u){const l="0123456789abcdef";let w,c,f="";const p=h/8,g=a===-1?3:0;for(w=0;w<p;w+=1)c=r[w>>>2]>>>8*(g+a*(w%4)),f+=l.charAt(c>>>4&15)+l.charAt(15&c);return u.outputUpper?f.toUpperCase():f}(i,t,n,e)};case"B64":return function(i){return function(r,h,a,u){let l,w,c,f,p,g="";const m=h/8,y=a===-1?3:0;for(l=0;l<m;l+=3)for(f=l+1<m?r[l+1>>>2]:0,p=l+2<m?r[l+2>>>2]:0,c=(r[l>>>2]>>>8*(y+a*(l%4))&255)<<16|(f>>>8*(y+a*((l+1)%4))&255)<<8|p>>>8*(y+a*((l+2)%4))&255,w=0;w<4;w+=1)g+=8*l+6*w<=h?ut.charAt(c>>>6*(3-w)&63):u.b64Pad;return g}(i,t,n,e)};case"BYTES":return function(i){return function(r,h,a){let u,l,w="";const c=h/8,f=a===-1?3:0;for(u=0;u<c;u+=1)l=r[u>>>2]>>>8*(f+a*(u%4))&255,w+=String.fromCharCode(l);return w}(i,t,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(at)}return function(i){return function(r,h,a){let u;const l=h/8,w=new ArrayBuffer(l),c=new Uint8Array(w),f=a===-1?3:0;for(u=0;u<l;u+=1)c[u]=r[u>>>2]>>>8*(f+a*(u%4))&255;return w}(i,t,n)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(lt)}return function(i){return function(r,h,a){let u;const l=h/8,w=a===-1?3:0,c=new Uint8Array(l);for(u=0;u<l;u+=1)c[u]=r[u>>>2]>>>8*(w+a*(u%4))&255;return c}(i,t,n)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const P=4294967296,d=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],L=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],U=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],O="Chosen SHA variant is not supported",ft="Cannot set numRounds with MAC";function X(s,t){let n,e;const i=s.binLen>>>3,r=t.binLen>>>3,h=i<<3,a=4-i<<3;if(i%4!=0){for(n=0;n<r;n+=4)e=i+n>>>2,s.value[e]|=t.value[n>>>2]<<h,s.value.push(0),s.value[e+1]|=t.value[n>>>2]>>>a;return(s.value.length<<2)-4>=r+i&&s.value.pop(),{value:s.value,binLen:s.binLen+t.binLen}}return{value:s.value.concat(t.value),binLen:s.binLen+t.binLen}}function J(s){const t={outputUpper:!1,b64Pad:"=",outputLen:-1},n=s||{},e="Output length must be a multiple of 8";if(t.outputUpper=n.outputUpper||!1,n.b64Pad&&(t.b64Pad=n.b64Pad),n.outputLen){if(n.outputLen%8!=0)throw new Error(e);t.outputLen=n.outputLen}else if(n.shakeLen){if(n.shakeLen%8!=0)throw new Error(e);t.outputLen=n.shakeLen}if(typeof t.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof t.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return t}function C(s,t,n,e){const i=s+" must include a value and format";if(!t){if(!e)throw new Error(i);return e}if(t.value===void 0||!t.format)throw new Error(i);return B(t.format,t.encoding||"UTF8",n)(t.value)}class _{constructor(t,n,e){const i=e||{};if(this.t=n,this.i=i.encoding||"UTF8",this.numRounds=i.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=t,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(t){let n,e=0;const i=this.m>>>5,r=this.C(t,this.h,this.u),h=r.binLen,a=r.value,u=h>>>5;for(n=0;n<u;n+=i)e+this.m<=h&&(this.U=this.v(a.slice(n,n+i),this.U),e+=this.m);return this.A+=e,this.h=a.slice(e>>>5),this.u=h%this.m,this.l=!0,this}getHash(t,n){let e,i,r=this.R;const h=J(n);if(this.K){if(h.outputLen===-1)throw new Error("Output length must be specified in options");r=h.outputLen}const a=V(t,r,this.T,h);if(this.H&&this.g)return a(this.g(h));for(i=this.F(this.h.slice(),this.u,this.A,this.L(this.U),r),e=1;e<this.numRounds;e+=1)this.K&&r%32!=0&&(i[i.length-1]&=16777215>>>24-r%32),i=this.F(i,r,0,this.B(this.o),r);return a(i)}setHMACKey(t,n,e){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const i=B(n,(e||{}).encoding||"UTF8",this.T);this.k(i(t))}k(t){const n=this.m>>>3,e=n/4-1;let i;if(this.numRounds!==1)throw new Error(ft);if(this.H)throw new Error("MAC key already set");for(n<t.binLen/8&&(t.value=this.F(t.value,t.binLen,0,this.B(this.o),this.R));t.value.length<=e;)t.value.push(0);for(i=0;i<=e;i+=1)this.S[i]=909522486^t.value[i],this.p[i]=1549556828^t.value[i];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(t,n){const e=J(n);return V(t,this.R,this.T,e)(this.Y())}Y(){let t;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");const n=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return t=this.v(this.p,this.B(this.o)),t=this.F(n,this.R,this.m,t,this.R),t}}function M(s,t){return s<<t|s>>>32-t}function H(s,t){return s>>>t|s<<32-t}function wt(s,t){return s>>>t}function W(s,t,n){return s^t^n}function dt(s,t,n){return s&t^~s&n}function gt(s,t,n){return s&t^s&n^t&n}function Bt(s){return H(s,2)^H(s,13)^H(s,22)}function I(s,t){const n=(65535&s)+(65535&t);return(65535&(s>>>16)+(t>>>16)+(n>>>16))<<16|65535&n}function kt(s,t,n,e){const i=(65535&s)+(65535&t)+(65535&n)+(65535&e);return(65535&(s>>>16)+(t>>>16)+(n>>>16)+(e>>>16)+(i>>>16))<<16|65535&i}function F(s,t,n,e,i){const r=(65535&s)+(65535&t)+(65535&n)+(65535&e)+(65535&i);return(65535&(s>>>16)+(t>>>16)+(n>>>16)+(e>>>16)+(i>>>16)+(r>>>16))<<16|65535&r}function xt(s){return H(s,7)^H(s,18)^wt(s,3)}function Ft(s){return H(s,6)^H(s,11)^H(s,25)}function Pt(s){return[1732584193,4023233417,2562383102,271733878,3285377520]}function pt(s,t){let n,e,i,r,h,a,u;const l=[];for(n=t[0],e=t[1],i=t[2],r=t[3],h=t[4],u=0;u<80;u+=1)l[u]=u<16?s[u]:M(l[u-3]^l[u-8]^l[u-14]^l[u-16],1),a=u<20?F(M(n,5),dt(e,i,r),h,1518500249,l[u]):u<40?F(M(n,5),W(e,i,r),h,1859775393,l[u]):u<60?F(M(n,5),gt(e,i,r),h,2400959708,l[u]):F(M(n,5),W(e,i,r),h,3395469782,l[u]),h=r,r=i,i=M(e,30),e=n,n=a;return t[0]=I(n,t[0]),t[1]=I(e,t[1]),t[2]=I(i,t[2]),t[3]=I(r,t[3]),t[4]=I(h,t[4]),t}function Ot(s,t,n,e){let i;const r=15+(t+65>>>9<<4),h=t+n;for(;s.length<=r;)s.push(0);for(s[t>>>5]|=128<<24-t%32,s[r]=4294967295&h,s[r-1]=h/P|0,i=0;i<s.length;i+=16)e=pt(s.slice(i,i+16),e);return e}let Yt=class extends _{constructor(s,t,n){if(s!=="SHA-1")throw new Error(O);super(s,t,n);const e=n||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=B(this.t,this.i,this.T),this.v=pt,this.L=function(i){return i.slice()},this.B=Pt,this.F=Ot,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,e.hmacKey&&this.k(C("hmacKey",e.hmacKey,this.T))}};function Z(s){let t;return t=s=="SHA-224"?L.slice():U.slice(),t}function Q(s,t){let n,e,i,r,h,a,u,l,w,c,f;const p=[];for(n=t[0],e=t[1],i=t[2],r=t[3],h=t[4],a=t[5],u=t[6],l=t[7],f=0;f<64;f+=1)p[f]=f<16?s[f]:kt(H(g=p[f-2],17)^H(g,19)^wt(g,10),p[f-7],xt(p[f-15]),p[f-16]),w=F(l,Ft(h),dt(h,a,u),d[f],p[f]),c=I(Bt(n),gt(n,e,i)),l=u,u=a,a=h,h=I(r,w),r=i,i=e,e=n,n=I(w,c);var g;return t[0]=I(n,t[0]),t[1]=I(e,t[1]),t[2]=I(i,t[2]),t[3]=I(r,t[3]),t[4]=I(h,t[4]),t[5]=I(a,t[5]),t[6]=I(u,t[6]),t[7]=I(l,t[7]),t}let Dt=class extends _{constructor(s,t,n){if(s!=="SHA-224"&&s!=="SHA-256")throw new Error(O);super(s,t,n);const e=n||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=B(this.t,this.i,this.T),this.v=Q,this.L=function(i){return i.slice()},this.B=Z,this.F=function(i,r,h,a){return function(u,l,w,c,f){let p,g;const m=15+(l+65>>>9<<4),y=l+w;for(;u.length<=m;)u.push(0);for(u[l>>>5]|=128<<24-l%32,u[m]=4294967295&y,u[m-1]=y/P|0,p=0;p<u.length;p+=16)c=Q(u.slice(p,p+16),c);return g=f==="SHA-224"?[c[0],c[1],c[2],c[3],c[4],c[5],c[6]]:c,g}(i,r,h,a,s)},this.U=Z(s),this.m=512,this.R=s==="SHA-224"?224:256,this.K=!1,e.hmacKey&&this.k(C("hmacKey",e.hmacKey,this.T))}};class o{constructor(t,n){this.N=t,this.I=n}}function tt(s,t){let n;return t>32?(n=64-t,new o(s.I<<t|s.N>>>n,s.N<<t|s.I>>>n)):t!==0?(n=32-t,new o(s.N<<t|s.I>>>n,s.I<<t|s.N>>>n)):s}function T(s,t){let n;return t<32?(n=32-t,new o(s.N>>>t|s.I<<n,s.I>>>t|s.N<<n)):(n=64-t,new o(s.I>>>t|s.N<<n,s.N>>>t|s.I<<n))}function mt(s,t){return new o(s.N>>>t,s.I>>>t|s.N<<32-t)}function Xt(s,t,n){return new o(s.N&t.N^s.N&n.N^t.N&n.N,s.I&t.I^s.I&n.I^t.I&n.I)}function _t(s){const t=T(s,28),n=T(s,34),e=T(s,39);return new o(t.N^n.N^e.N,t.I^n.I^e.I)}function S(s,t){let n,e;n=(65535&s.I)+(65535&t.I),e=(s.I>>>16)+(t.I>>>16)+(n>>>16);const i=(65535&e)<<16|65535&n;return n=(65535&s.N)+(65535&t.N)+(e>>>16),e=(s.N>>>16)+(t.N>>>16)+(n>>>16),new o((65535&e)<<16|65535&n,i)}function jt(s,t,n,e){let i,r;i=(65535&s.I)+(65535&t.I)+(65535&n.I)+(65535&e.I),r=(s.I>>>16)+(t.I>>>16)+(n.I>>>16)+(e.I>>>16)+(i>>>16);const h=(65535&r)<<16|65535&i;return i=(65535&s.N)+(65535&t.N)+(65535&n.N)+(65535&e.N)+(r>>>16),r=(s.N>>>16)+(t.N>>>16)+(n.N>>>16)+(e.N>>>16)+(i>>>16),new o((65535&r)<<16|65535&i,h)}function zt(s,t,n,e,i){let r,h;r=(65535&s.I)+(65535&t.I)+(65535&n.I)+(65535&e.I)+(65535&i.I),h=(s.I>>>16)+(t.I>>>16)+(n.I>>>16)+(e.I>>>16)+(i.I>>>16)+(r>>>16);const a=(65535&h)<<16|65535&r;return r=(65535&s.N)+(65535&t.N)+(65535&n.N)+(65535&e.N)+(65535&i.N)+(h>>>16),h=(s.N>>>16)+(t.N>>>16)+(n.N>>>16)+(e.N>>>16)+(i.N>>>16)+(r>>>16),new o((65535&h)<<16|65535&r,a)}function x(s,t){return new o(s.N^t.N,s.I^t.I)}function Gt(s){const t=T(s,19),n=T(s,61),e=mt(s,6);return new o(t.N^n.N^e.N,t.I^n.I^e.I)}function $t(s){const t=T(s,1),n=T(s,8),e=mt(s,7);return new o(t.N^n.N^e.N,t.I^n.I^e.I)}function qt(s){const t=T(s,14),n=T(s,18),e=T(s,41);return new o(t.N^n.N^e.N,t.I^n.I^e.I)}const Vt=[new o(d[0],3609767458),new o(d[1],602891725),new o(d[2],3964484399),new o(d[3],2173295548),new o(d[4],4081628472),new o(d[5],3053834265),new o(d[6],2937671579),new o(d[7],3664609560),new o(d[8],2734883394),new o(d[9],1164996542),new o(d[10],1323610764),new o(d[11],3590304994),new o(d[12],4068182383),new o(d[13],991336113),new o(d[14],633803317),new o(d[15],3479774868),new o(d[16],2666613458),new o(d[17],944711139),new o(d[18],2341262773),new o(d[19],2007800933),new o(d[20],1495990901),new o(d[21],1856431235),new o(d[22],3175218132),new o(d[23],2198950837),new o(d[24],3999719339),new o(d[25],766784016),new o(d[26],2566594879),new o(d[27],3203337956),new o(d[28],1034457026),new o(d[29],2466948901),new o(d[30],3758326383),new o(d[31],168717936),new o(d[32],1188179964),new o(d[33],1546045734),new o(d[34],1522805485),new o(d[35],2643833823),new o(d[36],2343527390),new o(d[37],1014477480),new o(d[38],1206759142),new o(d[39],344077627),new o(d[40],1290863460),new o(d[41],3158454273),new o(d[42],3505952657),new o(d[43],106217008),new o(d[44],3606008344),new o(d[45],1432725776),new o(d[46],1467031594),new o(d[47],851169720),new o(d[48],3100823752),new o(d[49],1363258195),new o(d[50],3750685593),new o(d[51],3785050280),new o(d[52],3318307427),new o(d[53],3812723403),new o(d[54],2003034995),new o(d[55],3602036899),new o(d[56],1575990012),new o(d[57],1125592928),new o(d[58],2716904306),new o(d[59],442776044),new o(d[60],593698344),new o(d[61],3733110249),new o(d[62],2999351573),new o(d[63],3815920427),new o(3391569614,3928383900),new o(3515267271,566280711),new o(3940187606,3454069534),new o(4118630271,4000239992),new o(116418474,1914138554),new o(174292421,2731055270),new o(289380356,3203993006),new o(460393269,320620315),new o(685471733,587496836),new o(852142971,1086792851),new o(1017036298,365543100),new o(1126000580,2618297676),new o(1288033470,3409855158),new o(1501505948,4234509866),new o(1607167915,987167468),new o(1816402316,1246189591)];function et(s){return s==="SHA-384"?[new o(3418070365,L[0]),new o(1654270250,L[1]),new o(2438529370,L[2]),new o(355462360,L[3]),new o(1731405415,L[4]),new o(41048885895,L[5]),new o(3675008525,L[6]),new o(1203062813,L[7])]:[new o(U[0],4089235720),new o(U[1],2227873595),new o(U[2],4271175723),new o(U[3],1595750129),new o(U[4],2917565137),new o(U[5],725511199),new o(U[6],4215389547),new o(U[7],327033209)]}function nt(s,t){let n,e,i,r,h,a,u,l,w,c,f,p;const g=[];for(n=t[0],e=t[1],i=t[2],r=t[3],h=t[4],a=t[5],u=t[6],l=t[7],f=0;f<80;f+=1)f<16?(p=2*f,g[f]=new o(s[p],s[p+1])):g[f]=jt(Gt(g[f-2]),g[f-7],$t(g[f-15]),g[f-16]),w=zt(l,qt(h),(y=a,A=u,new o((m=h).N&y.N^~m.N&A.N,m.I&y.I^~m.I&A.I)),Vt[f],g[f]),c=S(_t(n),Xt(n,e,i)),l=u,u=a,a=h,h=S(r,w),r=i,i=e,e=n,n=S(w,c);var m,y,A;return t[0]=S(n,t[0]),t[1]=S(e,t[1]),t[2]=S(i,t[2]),t[3]=S(r,t[3]),t[4]=S(h,t[4]),t[5]=S(a,t[5]),t[6]=S(u,t[6]),t[7]=S(l,t[7]),t}let Jt=class extends _{constructor(s,t,n){if(s!=="SHA-384"&&s!=="SHA-512")throw new Error(O);super(s,t,n);const e=n||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=B(this.t,this.i,this.T),this.v=nt,this.L=function(i){return i.slice()},this.B=et,this.F=function(i,r,h,a){return function(u,l,w,c,f){let p,g;const m=31+(l+129>>>10<<5),y=l+w;for(;u.length<=m;)u.push(0);for(u[l>>>5]|=128<<24-l%32,u[m]=4294967295&y,u[m-1]=y/P|0,p=0;p<u.length;p+=32)c=nt(u.slice(p,p+32),c);return g=f==="SHA-384"?[c[0].N,c[0].I,c[1].N,c[1].I,c[2].N,c[2].I,c[3].N,c[3].I,c[4].N,c[4].I,c[5].N,c[5].I]:[c[0].N,c[0].I,c[1].N,c[1].I,c[2].N,c[2].I,c[3].N,c[3].I,c[4].N,c[4].I,c[5].N,c[5].I,c[6].N,c[6].I,c[7].N,c[7].I],g}(i,r,h,a,s)},this.U=et(s),this.m=1024,this.R=s==="SHA-384"?384:512,this.K=!1,e.hmacKey&&this.k(C("hmacKey",e.hmacKey,this.T))}};const Wt=[new o(0,1),new o(0,32898),new o(2147483648,32906),new o(2147483648,2147516416),new o(0,32907),new o(0,2147483649),new o(2147483648,2147516545),new o(2147483648,32777),new o(0,138),new o(0,136),new o(0,2147516425),new o(0,2147483658),new o(0,2147516555),new o(2147483648,139),new o(2147483648,32905),new o(2147483648,32771),new o(2147483648,32770),new o(2147483648,128),new o(0,32778),new o(2147483648,2147483658),new o(2147483648,2147516545),new o(2147483648,32896),new o(0,2147483649),new o(2147483648,2147516424)],Zt=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function G(s){let t;const n=[];for(t=0;t<5;t+=1)n[t]=[new o(0,0),new o(0,0),new o(0,0),new o(0,0),new o(0,0)];return n}function Qt(s){let t;const n=[];for(t=0;t<5;t+=1)n[t]=s[t].slice();return n}function D(s,t){let n,e,i,r;const h=[],a=[];if(s!==null)for(e=0;e<s.length;e+=2)t[(e>>>1)%5][(e>>>1)/5|0]=x(t[(e>>>1)%5][(e>>>1)/5|0],new o(s[e+1],s[e]));for(n=0;n<24;n+=1){for(r=G(),e=0;e<5;e+=1)h[e]=(u=t[e][0],l=t[e][1],w=t[e][2],c=t[e][3],f=t[e][4],new o(u.N^l.N^w.N^c.N^f.N,u.I^l.I^w.I^c.I^f.I));for(e=0;e<5;e+=1)a[e]=x(h[(e+4)%5],tt(h[(e+1)%5],1));for(e=0;e<5;e+=1)for(i=0;i<5;i+=1)t[e][i]=x(t[e][i],a[e]);for(e=0;e<5;e+=1)for(i=0;i<5;i+=1)r[i][(2*e+3*i)%5]=tt(t[e][i],Zt[e][i]);for(e=0;e<5;e+=1)for(i=0;i<5;i+=1)t[e][i]=x(r[e][i],new o(~r[(e+1)%5][i].N&r[(e+2)%5][i].N,~r[(e+1)%5][i].I&r[(e+2)%5][i].I));t[0][0]=x(t[0][0],Wt[n])}var u,l,w,c,f;return t}function yt(s){let t,n,e=0;const i=[0,0],r=[4294967295&s,s/P&2097151];for(t=6;t>=0;t--)n=r[t>>2]>>>8*t&255,n===0&&e===0||(i[e+1>>2]|=n<<8*(e+1),e+=1);return e=e!==0?e:1,i[0]|=e,{value:e+1>4?i:[i[0]],binLen:8+8*e}}function j(s){return X(yt(s.binLen),s)}function st(s,t){let n,e=yt(t);e=X(e,s);const i=t>>>2,r=(i-e.value.length%i)%i;for(n=0;n<r;n++)e.value.push(0);return e.value}let te=class extends _{constructor(s,t,n){let e=6,i=0;super(s,t,n);const r=n||{};if(this.numRounds!==1){if(r.kmacKey||r.hmacKey)throw new Error(ft);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=B(this.t,this.i,this.T),this.v=D,this.L=Qt,this.B=G,this.U=G(),this.K=!1,s){case"SHA3-224":this.m=i=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=i=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=i=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=i=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":e=31,this.m=i=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":e=31,this.m=i=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":e=4,this.m=i=1344,this.X(n),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":e=4,this.m=i=1088,this.X(n),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=i=1344,e=this.O(n),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=i=1088,e=this.O(n),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(O)}this.F=function(h,a,u,l,w){return function(c,f,p,g,m,y,A){let v,E,b=0;const N=[],Y=m>>>5,vt=f>>>5;for(v=0;v<vt&&f>=m;v+=Y)g=D(c.slice(v,v+Y),g),f-=m;for(c=c.slice(v),f%=m;c.length<Y;)c.push(0);for(v=f>>>3,c[v>>2]^=y<<v%4*8,c[Y-1]^=2147483648,g=D(c,g);32*N.length<A&&(E=g[b%5][b/5|0],N.push(E.I),!(32*N.length>=A));)N.push(E.N),b+=1,64*b%m==0&&(D(null,g),b=0);return N}(h,a,0,l,i,e,w)},r.hmacKey&&this.k(C("hmacKey",r.hmacKey,this.T))}O(s,t){const n=function(i){const r=i||{};return{funcName:C("funcName",r.funcName,1,{value:[],binLen:0}),customization:C("Customization",r.customization,1,{value:[],binLen:0})}}(s||{});t&&(n.funcName=t);const e=X(j(n.funcName),j(n.customization));if(n.customization.binLen!==0||n.funcName.binLen!==0){const i=st(e,this.m>>>3);for(let r=0;r<i.length;r+=this.m>>>5)this.U=this.v(i.slice(r,r+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(s){const t=function(e){const i=e||{};return{kmacKey:C("kmacKey",i.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:C("Customization",i.customization,1,{value:[],binLen:0})}}(s||{});this.O(s,t.funcName);const n=st(j(t.kmacKey),this.m>>>3);for(let e=0;e<n.length;e+=this.m>>>5)this.U=this.v(n.slice(e,e+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(s){const t=X({value:this.h.slice(),binLen:this.u},function(n){let e,i,r=0;const h=[0,0],a=[4294967295&n,n/P&2097151];for(e=6;e>=0;e--)i=a[e>>2]>>>8*e&255,i===0&&r===0||(h[r>>2]|=i<<8*r,r+=1);return r=r!==0?r:1,h[r>>2]|=r<<8*r,{value:r+1>4?h:[h[0]],binLen:8+8*r}}(s.outputLen));return this.F(t.value,t.binLen,this.A,this.L(this.U),s.outputLen)}};class At{constructor(t,n,e){if(t=="SHA-1")this.P=new Yt(t,n,e);else if(t=="SHA-224"||t=="SHA-256")this.P=new Dt(t,n,e);else if(t=="SHA-384"||t=="SHA-512")this.P=new Jt(t,n,e);else{if(t!="SHA3-224"&&t!="SHA3-256"&&t!="SHA3-384"&&t!="SHA3-512"&&t!="SHAKE128"&&t!="SHAKE256"&&t!="CSHAKE128"&&t!="CSHAKE256"&&t!="KMAC128"&&t!="KMAC256")throw new Error(O);this.P=new te(t,n,e)}}update(t){return this.P.update(t),this}getHash(t,n){return this.P.getHash(t,n)}setHMACKey(t,n,e){this.P.setHMACKey(t,n,e)}getHMAC(t,n){return this.P.getHMAC(t,n)}}class it{constructor(t=30,n=6){if(this.expiry=t,this.length=n,this.length>8||this.length<6)throw"Error: invalid code length"}dec2hex(t){return(t<15.5?"0":"")+Math.round(t).toString(16)}hex2dec(t){return parseInt(t,16)}base32tohex(t){var n,e,i,r,h,a;for(n="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",e="",r="",h=0;h<t.length;)a=n.indexOf(t.charAt(h).toUpperCase()),e+=this.leftpad(a.toString(2),5,"0"),h++;for(h=0;h+4<=e.length;)i=e.substr(h,4),r=r+parseInt(i,2).toString(16),h+=4;return r}leftpad(t,n,e){return n+1>=t.length&&(t=Array(n+1-t.length).join(e)+t),t}getOtp(t,n=new Date().getTime()){var e,i,r,h,a,u,l;if(r=this.base32tohex(t),e=Math.round(n/1e3),l=this.leftpad(this.dec2hex(Math.floor(e/this.expiry)),16,"0"),u=new At("SHA-1","HEX"),u.setHMACKey(r,"HEX"),u.update(l),i=u.getHMAC("HEX"),i==="KEY MUST BE IN BYTE INCREMENTS")throw"Error: hex key must be in byte increments";return h=this.hex2dec(i.substring(i.length-1)),a=(this.hex2dec(i.substr(h*2,8))&this.hex2dec("7fffffff"))+"",a.length>this.length?a=a.substr(a.length-this.length,this.length):a=this.leftpad(a,this.length,"0"),a}}class ee{constructor(t=6){if(this.length=t,this.length>8||this.length<6)throw"Error: invalid code length"}uintToString(t){var n,e;return e=String.fromCharCode.apply(null,t),n=decodeURIComponent(escape(e)),n}getOtp(t,n){var e,i,r,h,a;return h=new At("SHA-1","TEXT"),h.setHMACKey(t,"TEXT"),h.update(this.uintToString(new Uint8Array(this.intToBytes(n)))),e=h.getHMAC("HEX"),i=this.hexToBytes(e),r=i[19]&15,a=(i[r]&127)<<24|(i[r+1]&255)<<16|(i[r+2]&255)<<8|i[r+3]&255,a=a+"",a.substr(a.length-this.length,this.length)}intToBytes(t){var n,e;for(n=[],e=7;e>=0;)n[e]=t&255,t=t>>8,--e;return n}hexToBytes(t){var n,e,i;for(e=[],i=0,n=t.length;i<n;)e.push(parseInt(t.substr(i,2),16)),i+=2;return e}}const ne=`<div class="item">
<div class="issuer">ISSUER</div>
<textarea class="code" rows="1">CODE</textarea>
</div>`;function se(s,t,n){(!s||s.length<2)&&(s=t),items.innerHTML+=ne.replace("ISSUER",s).replace("CODE",n)}function ie(){document.querySelectorAll(".item").forEach(s=>{s.addEventListener("click",function(t){var n=this.querySelector(".code");n.focus(),n.select();try{var e=document.execCommand("copy"),i=e?"successful":"unsuccessful";console.log("Copy email command was "+i,n.innerText)}catch{console.log("Oops, unable to copy")}})})}function rt(s){const t=new ee,n={6:new it(30,6),8:new it(30,8)};for(const e of s){let i;e.type===ct.HOTP?i=t.getOtp(e.secret,e.counter):e.digits in n?i=n[e.digits].getOtp(e.secret):console.warn("Unsupported digits",e.digits),se(e.issuer,e.name,i)}ie()}var ot=window.appStorage=new Mt;let z;function re(s){z||(z=new Ct),z.show(s)}document.addEventListener("DOMContentLoaded",()=>{password.addEventListener("keydown",async s=>{s.key=="13"&&rt(await ot.getData())}),btnSetting.addEventListener("click",()=>{re("import")});try{ot.getData().then(s=>{rt(s)})}catch{}});
