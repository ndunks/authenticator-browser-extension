var At=Object.defineProperty;var St=(s,t,e)=>t in s?At(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var I=(s,t,e)=>St(s,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();var q=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.SHA1=1]="SHA1",s[s.SHA256=2]="SHA256",s[s.SHA512=3]="SHA512",s[s.MD5=4]="MD5",s))(q||{}),it=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.HOTP=1]="HOTP",s[s.TOTP=2]="TOTP",s))(it||{});const It=`<form id="add-item" class="form-card" onsubmit="return false">
  <label>
    Name: <input type="text" name="name" required>
  </label><br>

  <label>
    Issuer: <input type="text" name="issuer" required>
  </label><br>

  <label>
    Secret (base32): <input type="text" name="secret" required>
  </label><br>

  <label>
    Algorithm:
    <select name="algorithm">
      <option value="1" selected>SHA1</option>
      <option value="2">SHA256</option>
      <option value="3">SHA512</option>
      <option value="4">MD5</option>
    </select>
  </label><br>

  <label>
    Type:
    <select name="type">
      <option value="1">HOTP</option>
      <option value="2" selected>TOTP</option>
    </select>
  </label><br>

  <label>
    Digits:
    <select name="digits">
      <option value="6" selected>6</option>
      <option value="8">8</option>
    </select>
  </label><br>

  <label>
    Counter (only for HOTP): <input type="number" name="counter">
  </label><br>
  <hr/>
  <label>
    Password (if set): <input autofocus type="password" name="password">
  </label><br>
  <button type="submit">Submit</button>
</form>`;class Et{constructor(){I(this,"title","Add Item");I(this,"content",It)}onShow(t){const e=t.body.querySelector("#add-item");e.addEventListener("submit",n=>{n.preventDefault();let{name:r,issuer:o,secret:i,algorithm:h,type:u,digits:l,counter:w,password:c}=Object.fromEntries([...new FormData(e).entries()].map(([p,g])=>[p,g.toString()]));const f={name:r,issuer:o,secret:i,digits:l?parseInt(l):void 0,counter:w?parseInt(w):void 0};if(h in q)f.algorithm=parseInt(h);else return alert("Invalid algorithm");if(u in q)f.type=parseInt(u);else return alert("Invalid type");appStorage.addItem(f,c).then(()=>location.reload()).catch(p=>alert("Invalid password"))})}}const Nt=Object.freeze(Object.defineProperty({__proto__:null,default:Et},Symbol.toStringTag,{value:"Module"})),Ht=`<form id="change-password" class="form-card" onsubmit="return false">
  <label>
    Current Password: <input type="password" name="current_password">
  </label><br>

  <label>
    New Password: <input type="password" name="new_password1">
  </label><br>

  <label>
    Repeat New Password: <input type="password" name="new_password2">
  </label><br>

  <button type="submit">Submit</button>
</form>`;class Tt{constructor(){I(this,"title","Change Password");I(this,"content",Ht)}onShow(t){const e=t.body.querySelector("#change-password");e.addEventListener("submit",n=>{n.preventDefault();const r=new FormData(e),o=Object.fromEntries(r.entries());if(o.new_password1!==o.new_password2)return alert("New passwords does not match");if(o.new_password1===o.current_password)return alert("No change");appStorage.changePassword(o.current_password.toString(),o.new_password1.toString()).then(()=>{alert("Password changed"),location.reload()}).catch(i=>{alert(`Failed: ${i.message||i}`)})})}}const Lt=Object.freeze(Object.defineProperty({__proto__:null,default:Tt},Symbol.toStringTag,{value:"Module"})),Ct="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split("");function Ut(s){const t=[];for(let r in s){const o=s[r].toString(2);let i=8-o.length,h="";for(let u=0;u<i;u++)h="0"+h;t.push(h+o)}let e=t.join(""),n=[];for(let r=0;r<e.length;r+=5){let o=e.substring(r,r+5);if(o.length<5){let h=5-o.length,u="";for(let l=0;l<h;l++)u+="0";o+=u}let i=parseInt(o,2);n.push(Ct[i])}if(n.length%8!=0){let r=8-n.length%8;for(let o=0;o<r;o++)n.push("=")}return n.join("")}function Rt(){const s=Date.now(),t=Math.floor(Math.random()*1e6),e=BigInt(s)*BigInt(1e6)+BigInt(t);return Math.floor(Math.random()*1e4).toString(36)+e.toString(36)}function Mt(s){const t=new Uint8Array(s.length);for(let e=0;e<s.length;e++)t[e]=s.charCodeAt(e);return t}function P(s,t){let e=0,n=0,r=0;for(;;){const o=s[t++];if(r++,e|=(o&127)<<n,(o&128)===0)break;n+=7}return{value:e,length:r}}function at(s){let t=0;const e=[];for(;t<s.length;){const n=s[t++],r=n>>3,o=n&7;if(r!==1){if(o===0){const{value:c,length:f}=P(s,t);console.warn(`Skipped field ${r} with int value: ${c}`),t+=f}else if(o===2){const{value:c,length:f}=P(s,t);console.warn(`Skipped field ${r} with value len: ${c}`),t+=f+c}else throw new Error(`Unsupported wire type: ${o}`);continue}if(o!==2)throw new Error(`Got fieldNum 1 but have invalid wireType: ${o}`);const{value:i,length:h}=P(s,t);t+=h;const u=s.slice(t,t+i);t+=i;let l=0;const w={};for(w.id=Rt();l<u.length;){const c=u[l++],f=c>>3,p=c&7;if(p===2){const{value:g,length:m}=P(u,l);l+=m;const b=u.slice(l,l+g);l+=g;const y=new TextDecoder().decode(b);f===1&&(w.secret=Ut(b)),f===2&&(w.name=y),f===3&&(w.issuer=y)}else if(p===0){const{value:g,length:m}=P(u,l);l+=m,f===4&&(w.algorithm=g),f===5&&(w.digits=g===1?6:8),f===6&&(w.type=g),f===7&&(w.counter=g)}}e.push(w)}return e}const Kt=`<div id="setting" class="tab">
    <textarea id="data" rows="10"></textarea>
    <input placeholder="Password" id="setPassword" value="" />
    <button id="btnSave">Save</button>
</div>`;class Bt{constructor(){I(this,"title","Import Accounts");I(this,"content",Kt)}onShow(t){const e=t.body.querySelector("#btnSave"),n=t.body.querySelector("#setPassword"),r=t.body.querySelector("#data");e.addEventListener("click",async()=>{const o=at(Mt(r.value));await appStorage.addItems(o,n.value).then(()=>location.reload())})}}const Pt=Object.freeze(Object.defineProperty({__proto__:null,default:Bt},Symbol.toStringTag,{value:"Module"})),ct="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ut="ARRAYBUFFER not supported by this environment",ht="UINT8ARRAY not supported by this environment";function $(s,t,e,n){let r,o,i;const h=t||[0],u=(e=e||0)>>>3,l=n===-1?3:0;for(r=0;r<s.length;r+=1)i=r+u,o=i>>>2,h.length<=o&&h.push(0),h[o]|=s[r]<<8*(l+n*(i%4));return{value:h,binLen:8*s.length+e}}function B(s,t,e){switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(s){case"HEX":return function(n,r,o){return function(i,h,u,l){let w,c,f,p;if(i.length%2!=0)throw new Error("String of HEX type must be in byte increments");const g=h||[0],m=(u=u||0)>>>3,b=l===-1?3:0;for(w=0;w<i.length;w+=2){if(c=parseInt(i.substr(w,2),16),isNaN(c))throw new Error("String of HEX type contains invalid characters");for(p=(w>>>1)+m,f=p>>>2;g.length<=f;)g.push(0);g[f]|=c<<8*(b+l*(p%4))}return{value:g,binLen:4*i.length+u}}(n,r,o,e)};case"TEXT":return function(n,r,o){return function(i,h,u,l,w){let c,f,p,g,m,b,y,v,E=0;const S=u||[0],N=(l=l||0)>>>3;if(h==="UTF8")for(y=w===-1?3:0,p=0;p<i.length;p+=1)for(c=i.charCodeAt(p),f=[],128>c?f.push(c):2048>c?(f.push(192|c>>>6),f.push(128|63&c)):55296>c||57344<=c?f.push(224|c>>>12,128|c>>>6&63,128|63&c):(p+=1,c=65536+((1023&c)<<10|1023&i.charCodeAt(p)),f.push(240|c>>>18,128|c>>>12&63,128|c>>>6&63,128|63&c)),g=0;g<f.length;g+=1){for(b=E+N,m=b>>>2;S.length<=m;)S.push(0);S[m]|=f[g]<<8*(y+w*(b%4)),E+=1}else for(y=w===-1?2:0,v=h==="UTF16LE"&&w!==1||h!=="UTF16LE"&&w===1,p=0;p<i.length;p+=1){for(c=i.charCodeAt(p),v===!0&&(g=255&c,c=g<<8|c>>>8),b=E+N,m=b>>>2;S.length<=m;)S.push(0);S[m]|=c<<8*(y+w*(b%4)),E+=2}return{value:S,binLen:8*E+l}}(n,t,r,o,e)};case"B64":return function(n,r,o){return function(i,h,u,l){let w,c,f,p,g,m,b,y=0;const v=h||[0],E=(u=u||0)>>>3,S=l===-1?3:0,N=i.indexOf("=");if(i.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(i=i.replace(/=/g,""),N!==-1&&N<i.length)throw new Error("Invalid '=' found in base-64 string");for(c=0;c<i.length;c+=4){for(g=i.substr(c,4),p=0,f=0;f<g.length;f+=1)w=ct.indexOf(g.charAt(f)),p|=w<<18-6*f;for(f=0;f<g.length-1;f+=1){for(b=y+E,m=b>>>2;v.length<=m;)v.push(0);v[m]|=(p>>>16-8*f&255)<<8*(S+l*(b%4)),y+=1}}return{value:v,binLen:8*y+u}}(n,r,o,e)};case"BYTES":return function(n,r,o){return function(i,h,u,l){let w,c,f,p;const g=h||[0],m=(u=u||0)>>>3,b=l===-1?3:0;for(c=0;c<i.length;c+=1)w=i.charCodeAt(c),p=c+m,f=p>>>2,g.length<=f&&g.push(0),g[f]|=w<<8*(b+l*(p%4));return{value:g,binLen:8*i.length+u}}(n,r,o,e)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(ut)}return function(n,r,o){return function(i,h,u,l){return $(new Uint8Array(i),h,u,l)}(n,r,o,e)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(ht)}return function(n,r,o){return $(n,r,o,e)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function G(s,t,e,n){switch(s){case"HEX":return function(r){return function(o,i,h,u){const l="0123456789abcdef";let w,c,f="";const p=i/8,g=h===-1?3:0;for(w=0;w<p;w+=1)c=o[w>>>2]>>>8*(g+h*(w%4)),f+=l.charAt(c>>>4&15)+l.charAt(15&c);return u.outputUpper?f.toUpperCase():f}(r,t,e,n)};case"B64":return function(r){return function(o,i,h,u){let l,w,c,f,p,g="";const m=i/8,b=h===-1?3:0;for(l=0;l<m;l+=3)for(f=l+1<m?o[l+1>>>2]:0,p=l+2<m?o[l+2>>>2]:0,c=(o[l>>>2]>>>8*(b+h*(l%4))&255)<<16|(f>>>8*(b+h*((l+1)%4))&255)<<8|p>>>8*(b+h*((l+2)%4))&255,w=0;w<4;w+=1)g+=8*l+6*w<=i?ct.charAt(c>>>6*(3-w)&63):u.b64Pad;return g}(r,t,e,n)};case"BYTES":return function(r){return function(o,i,h){let u,l,w="";const c=i/8,f=h===-1?3:0;for(u=0;u<c;u+=1)l=o[u>>>2]>>>8*(f+h*(u%4))&255,w+=String.fromCharCode(l);return w}(r,t,e)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(ut)}return function(r){return function(o,i,h){let u;const l=i/8,w=new ArrayBuffer(l),c=new Uint8Array(w),f=h===-1?3:0;for(u=0;u<l;u+=1)c[u]=o[u>>>2]>>>8*(f+h*(u%4))&255;return w}(r,t,e)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(ht)}return function(r){return function(o,i,h){let u;const l=i/8,w=h===-1?3:0,c=new Uint8Array(l);for(u=0;u<l;u+=1)c[u]=o[u>>>2]>>>8*(w+h*(u%4))&255;return c}(r,t,e)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const x=4294967296,d=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],C=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],U=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],F="Chosen SHA variant is not supported",lt="Cannot set numRounds with MAC";function Y(s,t){let e,n;const r=s.binLen>>>3,o=t.binLen>>>3,i=r<<3,h=4-r<<3;if(r%4!=0){for(e=0;e<o;e+=4)n=r+e>>>2,s.value[n]|=t.value[e>>>2]<<i,s.value.push(0),s.value[n+1]|=t.value[e>>>2]>>>h;return(s.value.length<<2)-4>=o+r&&s.value.pop(),{value:s.value,binLen:s.binLen+t.binLen}}return{value:s.value.concat(t.value),binLen:s.binLen+t.binLen}}function W(s){const t={outputUpper:!1,b64Pad:"=",outputLen:-1},e=s||{},n="Output length must be a multiple of 8";if(t.outputUpper=e.outputUpper||!1,e.b64Pad&&(t.b64Pad=e.b64Pad),e.outputLen){if(e.outputLen%8!=0)throw new Error(n);t.outputLen=e.outputLen}else if(e.shakeLen){if(e.shakeLen%8!=0)throw new Error(n);t.outputLen=e.shakeLen}if(typeof t.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof t.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return t}function R(s,t,e,n){const r=s+" must include a value and format";if(!t){if(!n)throw new Error(r);return n}if(t.value===void 0||!t.format)throw new Error(r);return B(t.format,t.encoding||"UTF8",e)(t.value)}class j{constructor(t,e,n){const r=n||{};if(this.t=e,this.i=r.encoding||"UTF8",this.numRounds=r.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=t,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(t){let e,n=0;const r=this.m>>>5,o=this.C(t,this.h,this.u),i=o.binLen,h=o.value,u=i>>>5;for(e=0;e<u;e+=r)n+this.m<=i&&(this.U=this.v(h.slice(e,e+r),this.U),n+=this.m);return this.A+=n,this.h=h.slice(n>>>5),this.u=i%this.m,this.l=!0,this}getHash(t,e){let n,r,o=this.R;const i=W(e);if(this.K){if(i.outputLen===-1)throw new Error("Output length must be specified in options");o=i.outputLen}const h=G(t,o,this.T,i);if(this.H&&this.g)return h(this.g(i));for(r=this.F(this.h.slice(),this.u,this.A,this.L(this.U),o),n=1;n<this.numRounds;n+=1)this.K&&o%32!=0&&(r[r.length-1]&=16777215>>>24-o%32),r=this.F(r,o,0,this.B(this.o),o);return h(r)}setHMACKey(t,e,n){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const r=B(e,(n||{}).encoding||"UTF8",this.T);this.k(r(t))}k(t){const e=this.m>>>3,n=e/4-1;let r;if(this.numRounds!==1)throw new Error(lt);if(this.H)throw new Error("MAC key already set");for(e<t.binLen/8&&(t.value=this.F(t.value,t.binLen,0,this.B(this.o),this.R));t.value.length<=n;)t.value.push(0);for(r=0;r<=n;r+=1)this.S[r]=909522486^t.value[r],this.p[r]=1549556828^t.value[r];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(t,e){const n=W(e);return G(t,this.R,this.T,n)(this.Y())}Y(){let t;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");const e=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return t=this.v(this.p,this.B(this.o)),t=this.F(e,this.R,this.m,t,this.R),t}}function M(s,t){return s<<t|s>>>32-t}function T(s,t){return s>>>t|s<<32-t}function ft(s,t){return s>>>t}function V(s,t,e){return s^t^e}function wt(s,t,e){return s&t^~s&e}function dt(s,t,e){return s&t^s&e^t&e}function _t(s){return T(s,2)^T(s,13)^T(s,22)}function A(s,t){const e=(65535&s)+(65535&t);return(65535&(s>>>16)+(t>>>16)+(e>>>16))<<16|65535&e}function kt(s,t,e,n){const r=(65535&s)+(65535&t)+(65535&e)+(65535&n);return(65535&(s>>>16)+(t>>>16)+(e>>>16)+(n>>>16)+(r>>>16))<<16|65535&r}function k(s,t,e,n,r){const o=(65535&s)+(65535&t)+(65535&e)+(65535&n)+(65535&r);return(65535&(s>>>16)+(t>>>16)+(e>>>16)+(n>>>16)+(r>>>16)+(o>>>16))<<16|65535&o}function xt(s){return T(s,7)^T(s,18)^ft(s,3)}function Ft(s){return T(s,6)^T(s,11)^T(s,25)}function Dt(s){return[1732584193,4023233417,2562383102,271733878,3285377520]}function pt(s,t){let e,n,r,o,i,h,u;const l=[];for(e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],u=0;u<80;u+=1)l[u]=u<16?s[u]:M(l[u-3]^l[u-8]^l[u-14]^l[u-16],1),h=u<20?k(M(e,5),wt(n,r,o),i,1518500249,l[u]):u<40?k(M(e,5),V(n,r,o),i,1859775393,l[u]):u<60?k(M(e,5),dt(n,r,o),i,2400959708,l[u]):k(M(e,5),V(n,r,o),i,3395469782,l[u]),i=o,o=r,r=M(n,30),n=e,e=h;return t[0]=A(e,t[0]),t[1]=A(n,t[1]),t[2]=A(r,t[2]),t[3]=A(o,t[3]),t[4]=A(i,t[4]),t}function Ot(s,t,e,n){let r;const o=15+(t+65>>>9<<4),i=t+e;for(;s.length<=o;)s.push(0);for(s[t>>>5]|=128<<24-t%32,s[o]=4294967295&i,s[o-1]=i/x|0,r=0;r<s.length;r+=16)n=pt(s.slice(r,r+16),n);return n}let Yt=class extends j{constructor(s,t,e){if(s!=="SHA-1")throw new Error(F);super(s,t,e);const n=e||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=B(this.t,this.i,this.T),this.v=pt,this.L=function(r){return r.slice()},this.B=Dt,this.F=Ot,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,n.hmacKey&&this.k(R("hmacKey",n.hmacKey,this.T))}};function J(s){let t;return t=s=="SHA-224"?C.slice():U.slice(),t}function Z(s,t){let e,n,r,o,i,h,u,l,w,c,f;const p=[];for(e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],h=t[5],u=t[6],l=t[7],f=0;f<64;f+=1)p[f]=f<16?s[f]:kt(T(g=p[f-2],17)^T(g,19)^ft(g,10),p[f-7],xt(p[f-15]),p[f-16]),w=k(l,Ft(i),wt(i,h,u),d[f],p[f]),c=A(_t(e),dt(e,n,r)),l=u,u=h,h=i,i=A(o,w),o=r,r=n,n=e,e=A(w,c);var g;return t[0]=A(e,t[0]),t[1]=A(n,t[1]),t[2]=A(r,t[2]),t[3]=A(o,t[3]),t[4]=A(i,t[4]),t[5]=A(h,t[5]),t[6]=A(u,t[6]),t[7]=A(l,t[7]),t}let jt=class extends j{constructor(s,t,e){if(s!=="SHA-224"&&s!=="SHA-256")throw new Error(F);super(s,t,e);const n=e||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=B(this.t,this.i,this.T),this.v=Z,this.L=function(r){return r.slice()},this.B=J,this.F=function(r,o,i,h){return function(u,l,w,c,f){let p,g;const m=15+(l+65>>>9<<4),b=l+w;for(;u.length<=m;)u.push(0);for(u[l>>>5]|=128<<24-l%32,u[m]=4294967295&b,u[m-1]=b/x|0,p=0;p<u.length;p+=16)c=Z(u.slice(p,p+16),c);return g=f==="SHA-224"?[c[0],c[1],c[2],c[3],c[4],c[5],c[6]]:c,g}(r,o,i,h,s)},this.U=J(s),this.m=512,this.R=s==="SHA-224"?224:256,this.K=!1,n.hmacKey&&this.k(R("hmacKey",n.hmacKey,this.T))}};class a{constructor(t,e){this.N=t,this.I=e}}function Q(s,t){let e;return t>32?(e=64-t,new a(s.I<<t|s.N>>>e,s.N<<t|s.I>>>e)):t!==0?(e=32-t,new a(s.N<<t|s.I>>>e,s.I<<t|s.N>>>e)):s}function L(s,t){let e;return t<32?(e=32-t,new a(s.N>>>t|s.I<<e,s.I>>>t|s.N<<e)):(e=64-t,new a(s.I>>>t|s.N<<e,s.N>>>t|s.I<<e))}function gt(s,t){return new a(s.N>>>t,s.I>>>t|s.N<<32-t)}function Xt(s,t,e){return new a(s.N&t.N^s.N&e.N^t.N&e.N,s.I&t.I^s.I&e.I^t.I&e.I)}function qt(s){const t=L(s,28),e=L(s,34),n=L(s,39);return new a(t.N^e.N^n.N,t.I^e.I^n.I)}function H(s,t){let e,n;e=(65535&s.I)+(65535&t.I),n=(s.I>>>16)+(t.I>>>16)+(e>>>16);const r=(65535&n)<<16|65535&e;return e=(65535&s.N)+(65535&t.N)+(n>>>16),n=(s.N>>>16)+(t.N>>>16)+(e>>>16),new a((65535&n)<<16|65535&e,r)}function zt(s,t,e,n){let r,o;r=(65535&s.I)+(65535&t.I)+(65535&e.I)+(65535&n.I),o=(s.I>>>16)+(t.I>>>16)+(e.I>>>16)+(n.I>>>16)+(r>>>16);const i=(65535&o)<<16|65535&r;return r=(65535&s.N)+(65535&t.N)+(65535&e.N)+(65535&n.N)+(o>>>16),o=(s.N>>>16)+(t.N>>>16)+(e.N>>>16)+(n.N>>>16)+(r>>>16),new a((65535&o)<<16|65535&r,i)}function $t(s,t,e,n,r){let o,i;o=(65535&s.I)+(65535&t.I)+(65535&e.I)+(65535&n.I)+(65535&r.I),i=(s.I>>>16)+(t.I>>>16)+(e.I>>>16)+(n.I>>>16)+(r.I>>>16)+(o>>>16);const h=(65535&i)<<16|65535&o;return o=(65535&s.N)+(65535&t.N)+(65535&e.N)+(65535&n.N)+(65535&r.N)+(i>>>16),i=(s.N>>>16)+(t.N>>>16)+(e.N>>>16)+(n.N>>>16)+(r.N>>>16)+(o>>>16),new a((65535&i)<<16|65535&o,h)}function _(s,t){return new a(s.N^t.N,s.I^t.I)}function Gt(s){const t=L(s,19),e=L(s,61),n=gt(s,6);return new a(t.N^e.N^n.N,t.I^e.I^n.I)}function Wt(s){const t=L(s,1),e=L(s,8),n=gt(s,7);return new a(t.N^e.N^n.N,t.I^e.I^n.I)}function Vt(s){const t=L(s,14),e=L(s,18),n=L(s,41);return new a(t.N^e.N^n.N,t.I^e.I^n.I)}const Jt=[new a(d[0],3609767458),new a(d[1],602891725),new a(d[2],3964484399),new a(d[3],2173295548),new a(d[4],4081628472),new a(d[5],3053834265),new a(d[6],2937671579),new a(d[7],3664609560),new a(d[8],2734883394),new a(d[9],1164996542),new a(d[10],1323610764),new a(d[11],3590304994),new a(d[12],4068182383),new a(d[13],991336113),new a(d[14],633803317),new a(d[15],3479774868),new a(d[16],2666613458),new a(d[17],944711139),new a(d[18],2341262773),new a(d[19],2007800933),new a(d[20],1495990901),new a(d[21],1856431235),new a(d[22],3175218132),new a(d[23],2198950837),new a(d[24],3999719339),new a(d[25],766784016),new a(d[26],2566594879),new a(d[27],3203337956),new a(d[28],1034457026),new a(d[29],2466948901),new a(d[30],3758326383),new a(d[31],168717936),new a(d[32],1188179964),new a(d[33],1546045734),new a(d[34],1522805485),new a(d[35],2643833823),new a(d[36],2343527390),new a(d[37],1014477480),new a(d[38],1206759142),new a(d[39],344077627),new a(d[40],1290863460),new a(d[41],3158454273),new a(d[42],3505952657),new a(d[43],106217008),new a(d[44],3606008344),new a(d[45],1432725776),new a(d[46],1467031594),new a(d[47],851169720),new a(d[48],3100823752),new a(d[49],1363258195),new a(d[50],3750685593),new a(d[51],3785050280),new a(d[52],3318307427),new a(d[53],3812723403),new a(d[54],2003034995),new a(d[55],3602036899),new a(d[56],1575990012),new a(d[57],1125592928),new a(d[58],2716904306),new a(d[59],442776044),new a(d[60],593698344),new a(d[61],3733110249),new a(d[62],2999351573),new a(d[63],3815920427),new a(3391569614,3928383900),new a(3515267271,566280711),new a(3940187606,3454069534),new a(4118630271,4000239992),new a(116418474,1914138554),new a(174292421,2731055270),new a(289380356,3203993006),new a(460393269,320620315),new a(685471733,587496836),new a(852142971,1086792851),new a(1017036298,365543100),new a(1126000580,2618297676),new a(1288033470,3409855158),new a(1501505948,4234509866),new a(1607167915,987167468),new a(1816402316,1246189591)];function tt(s){return s==="SHA-384"?[new a(3418070365,C[0]),new a(1654270250,C[1]),new a(2438529370,C[2]),new a(355462360,C[3]),new a(1731405415,C[4]),new a(41048885895,C[5]),new a(3675008525,C[6]),new a(1203062813,C[7])]:[new a(U[0],4089235720),new a(U[1],2227873595),new a(U[2],4271175723),new a(U[3],1595750129),new a(U[4],2917565137),new a(U[5],725511199),new a(U[6],4215389547),new a(U[7],327033209)]}function et(s,t){let e,n,r,o,i,h,u,l,w,c,f,p;const g=[];for(e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],h=t[5],u=t[6],l=t[7],f=0;f<80;f+=1)f<16?(p=2*f,g[f]=new a(s[p],s[p+1])):g[f]=zt(Gt(g[f-2]),g[f-7],Wt(g[f-15]),g[f-16]),w=$t(l,Vt(i),(b=h,y=u,new a((m=i).N&b.N^~m.N&y.N,m.I&b.I^~m.I&y.I)),Jt[f],g[f]),c=H(qt(e),Xt(e,n,r)),l=u,u=h,h=i,i=H(o,w),o=r,r=n,n=e,e=H(w,c);var m,b,y;return t[0]=H(e,t[0]),t[1]=H(n,t[1]),t[2]=H(r,t[2]),t[3]=H(o,t[3]),t[4]=H(i,t[4]),t[5]=H(h,t[5]),t[6]=H(u,t[6]),t[7]=H(l,t[7]),t}let Zt=class extends j{constructor(s,t,e){if(s!=="SHA-384"&&s!=="SHA-512")throw new Error(F);super(s,t,e);const n=e||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=B(this.t,this.i,this.T),this.v=et,this.L=function(r){return r.slice()},this.B=tt,this.F=function(r,o,i,h){return function(u,l,w,c,f){let p,g;const m=31+(l+129>>>10<<5),b=l+w;for(;u.length<=m;)u.push(0);for(u[l>>>5]|=128<<24-l%32,u[m]=4294967295&b,u[m-1]=b/x|0,p=0;p<u.length;p+=32)c=et(u.slice(p,p+32),c);return g=f==="SHA-384"?[c[0].N,c[0].I,c[1].N,c[1].I,c[2].N,c[2].I,c[3].N,c[3].I,c[4].N,c[4].I,c[5].N,c[5].I]:[c[0].N,c[0].I,c[1].N,c[1].I,c[2].N,c[2].I,c[3].N,c[3].I,c[4].N,c[4].I,c[5].N,c[5].I,c[6].N,c[6].I,c[7].N,c[7].I],g}(r,o,i,h,s)},this.U=tt(s),this.m=1024,this.R=s==="SHA-384"?384:512,this.K=!1,n.hmacKey&&this.k(R("hmacKey",n.hmacKey,this.T))}};const Qt=[new a(0,1),new a(0,32898),new a(2147483648,32906),new a(2147483648,2147516416),new a(0,32907),new a(0,2147483649),new a(2147483648,2147516545),new a(2147483648,32777),new a(0,138),new a(0,136),new a(0,2147516425),new a(0,2147483658),new a(0,2147516555),new a(2147483648,139),new a(2147483648,32905),new a(2147483648,32771),new a(2147483648,32770),new a(2147483648,128),new a(0,32778),new a(2147483648,2147483658),new a(2147483648,2147516545),new a(2147483648,32896),new a(0,2147483649),new a(2147483648,2147516424)],te=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function z(s){let t;const e=[];for(t=0;t<5;t+=1)e[t]=[new a(0,0),new a(0,0),new a(0,0),new a(0,0),new a(0,0)];return e}function ee(s){let t;const e=[];for(t=0;t<5;t+=1)e[t]=s[t].slice();return e}function O(s,t){let e,n,r,o;const i=[],h=[];if(s!==null)for(n=0;n<s.length;n+=2)t[(n>>>1)%5][(n>>>1)/5|0]=_(t[(n>>>1)%5][(n>>>1)/5|0],new a(s[n+1],s[n]));for(e=0;e<24;e+=1){for(o=z(),n=0;n<5;n+=1)i[n]=(u=t[n][0],l=t[n][1],w=t[n][2],c=t[n][3],f=t[n][4],new a(u.N^l.N^w.N^c.N^f.N,u.I^l.I^w.I^c.I^f.I));for(n=0;n<5;n+=1)h[n]=_(i[(n+4)%5],Q(i[(n+1)%5],1));for(n=0;n<5;n+=1)for(r=0;r<5;r+=1)t[n][r]=_(t[n][r],h[n]);for(n=0;n<5;n+=1)for(r=0;r<5;r+=1)o[r][(2*n+3*r)%5]=Q(t[n][r],te[n][r]);for(n=0;n<5;n+=1)for(r=0;r<5;r+=1)t[n][r]=_(o[n][r],new a(~o[(n+1)%5][r].N&o[(n+2)%5][r].N,~o[(n+1)%5][r].I&o[(n+2)%5][r].I));t[0][0]=_(t[0][0],Qt[e])}var u,l,w,c,f;return t}function mt(s){let t,e,n=0;const r=[0,0],o=[4294967295&s,s/x&2097151];for(t=6;t>=0;t--)e=o[t>>2]>>>8*t&255,e===0&&n===0||(r[n+1>>2]|=e<<8*(n+1),n+=1);return n=n!==0?n:1,r[0]|=n,{value:n+1>4?r:[r[0]],binLen:8+8*n}}function X(s){return Y(mt(s.binLen),s)}function nt(s,t){let e,n=mt(t);n=Y(n,s);const r=t>>>2,o=(r-n.value.length%r)%r;for(e=0;e<o;e++)n.value.push(0);return n.value}let ne=class extends j{constructor(s,t,e){let n=6,r=0;super(s,t,e);const o=e||{};if(this.numRounds!==1){if(o.kmacKey||o.hmacKey)throw new Error(lt);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=B(this.t,this.i,this.T),this.v=O,this.L=ee,this.B=z,this.U=z(),this.K=!1,s){case"SHA3-224":this.m=r=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=r=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=r=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=r=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":n=31,this.m=r=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":n=31,this.m=r=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":n=4,this.m=r=1344,this.X(e),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":n=4,this.m=r=1088,this.X(e),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=r=1344,n=this.O(e),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=r=1088,n=this.O(e),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(F)}this.F=function(i,h,u,l,w){return function(c,f,p,g,m,b,y){let v,E,S=0;const N=[],D=m>>>5,vt=f>>>5;for(v=0;v<vt&&f>=m;v+=D)g=O(c.slice(v,v+D),g),f-=m;for(c=c.slice(v),f%=m;c.length<D;)c.push(0);for(v=f>>>3,c[v>>2]^=b<<v%4*8,c[D-1]^=2147483648,g=O(c,g);32*N.length<y&&(E=g[S%5][S/5|0],N.push(E.I),!(32*N.length>=y));)N.push(E.N),S+=1,64*S%m==0&&(O(null,g),S=0);return N}(i,h,0,l,r,n,w)},o.hmacKey&&this.k(R("hmacKey",o.hmacKey,this.T))}O(s,t){const e=function(r){const o=r||{};return{funcName:R("funcName",o.funcName,1,{value:[],binLen:0}),customization:R("Customization",o.customization,1,{value:[],binLen:0})}}(s||{});t&&(e.funcName=t);const n=Y(X(e.funcName),X(e.customization));if(e.customization.binLen!==0||e.funcName.binLen!==0){const r=nt(n,this.m>>>3);for(let o=0;o<r.length;o+=this.m>>>5)this.U=this.v(r.slice(o,o+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(s){const t=function(n){const r=n||{};return{kmacKey:R("kmacKey",r.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:R("Customization",r.customization,1,{value:[],binLen:0})}}(s||{});this.O(s,t.funcName);const e=nt(X(t.kmacKey),this.m>>>3);for(let n=0;n<e.length;n+=this.m>>>5)this.U=this.v(e.slice(n,n+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(s){const t=Y({value:this.h.slice(),binLen:this.u},function(e){let n,r,o=0;const i=[0,0],h=[4294967295&e,e/x&2097151];for(n=6;n>=0;n--)r=h[n>>2]>>>8*n&255,r===0&&o===0||(i[o>>2]|=r<<8*o,o+=1);return o=o!==0?o:1,i[o>>2]|=o<<8*o,{value:o+1>4?i:[i[0]],binLen:8+8*o}}(s.outputLen));return this.F(t.value,t.binLen,this.A,this.L(this.U),s.outputLen)}};class bt{constructor(t,e,n){if(t=="SHA-1")this.P=new Yt(t,e,n);else if(t=="SHA-224"||t=="SHA-256")this.P=new jt(t,e,n);else if(t=="SHA-384"||t=="SHA-512")this.P=new Zt(t,e,n);else{if(t!="SHA3-224"&&t!="SHA3-256"&&t!="SHA3-384"&&t!="SHA3-512"&&t!="SHAKE128"&&t!="SHAKE256"&&t!="CSHAKE128"&&t!="CSHAKE256"&&t!="KMAC128"&&t!="KMAC256")throw new Error(F);this.P=new ne(t,e,n)}}update(t){return this.P.update(t),this}getHash(t,e){return this.P.getHash(t,e)}setHMACKey(t,e,n){this.P.setHMACKey(t,e,n)}getHMAC(t,e){return this.P.getHMAC(t,e)}}class st{constructor(t=30,e=6){if(this.expiry=t,this.length=e,this.length>8||this.length<6)throw"Error: invalid code length"}dec2hex(t){return(t<15.5?"0":"")+Math.round(t).toString(16)}hex2dec(t){return parseInt(t,16)}base32tohex(t){var e,n,r,o,i,h;for(e="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",n="",o="",i=0;i<t.length;)h=e.indexOf(t.charAt(i).toUpperCase()),n+=this.leftpad(h.toString(2),5,"0"),i++;for(i=0;i+4<=n.length;)r=n.substr(i,4),o=o+parseInt(r,2).toString(16),i+=4;return o}leftpad(t,e,n){return e+1>=t.length&&(t=Array(e+1-t.length).join(n)+t),t}getOtp(t,e=new Date().getTime()){var n,r,o,i,h,u,l;if(o=this.base32tohex(t),n=Math.round(e/1e3),l=this.leftpad(this.dec2hex(Math.floor(n/this.expiry)),16,"0"),u=new bt("SHA-1","HEX"),u.setHMACKey(o,"HEX"),u.update(l),r=u.getHMAC("HEX"),r==="KEY MUST BE IN BYTE INCREMENTS")throw"Error: hex key must be in byte increments";return i=this.hex2dec(r.substring(r.length-1)),h=(this.hex2dec(r.substr(i*2,8))&this.hex2dec("7fffffff"))+"",h.length>this.length?h=h.substr(h.length-this.length,this.length):h=this.leftpad(h,this.length,"0"),h}}class se{constructor(t=6){if(this.length=t,this.length>8||this.length<6)throw"Error: invalid code length"}uintToString(t){var e,n;return n=String.fromCharCode.apply(null,t),e=decodeURIComponent(escape(n)),e}getOtp(t,e){var n,r,o,i,h;return i=new bt("SHA-1","TEXT"),i.setHMACKey(t,"TEXT"),i.update(this.uintToString(new Uint8Array(this.intToBytes(e)))),n=i.getHMAC("HEX"),r=this.hexToBytes(n),o=r[19]&15,h=(r[o]&127)<<24|(r[o+1]&255)<<16|(r[o+2]&255)<<8|r[o+3]&255,h=h+"",h.substr(h.length-this.length,this.length)}intToBytes(t){var e,n;for(e=[],n=7;n>=0;)e[n]=t&255,t=t>>8,--n;return e}hexToBytes(t){var e,n,r;for(n=[],r=0,e=t.length;r<e;)n.push(parseInt(t.substr(r,2),16)),r+=2;return n}}const re=`<div class="item">
<div class="issuer">ISSUER</div>
<textarea class="code" rows="1">CODE</textarea>
</div>`;function oe(s,t,e){(!s||s.length<2)&&(s=t),items.innerHTML+=re.replace("ISSUER",s).replace("CODE",e)}function ie(){document.querySelectorAll(".item").forEach(s=>{s.addEventListener("click",function(t){var e=this.querySelector(".code");e.focus(),e.select();try{var n=document.execCommand("copy"),r=n?"successful":"unsuccessful";console.log("Copy email command was "+r,e.innerText)}catch{console.log("Oops, unable to copy")}})})}async function yt(s,t){const e=await appStorage.getData(s).catch(o=>(console.error(o),t||alert("Invalid password"),Promise.reject(o)));if(!e)return;const n=new se,r={6:new st(30,6),8:new st(30,8)};for(const o of e){let i;o.type===it.HOTP?i=n.getOtp(o.secret,o.counter):o.digits in r?i=r[o.digits].getOtp(o.secret):console.warn("Unsupported digits",o.digits),oe(o.issuer,o.name,i)}ie()}const ae=`<form id="password" class="form-card" onsubmit="return false">
  <label>
    Password: <input required autofocus type="password" name="password">
  </label><br>
  <button type="submit">Submit</button>
</form>`;class ce{constructor(){I(this,"title","Input Password");I(this,"content",ae)}onShow(t){const e=t.body.querySelector("#password");e.addEventListener("submit",n=>{n.preventDefault(),yt(e.querySelector("[name=password]").value).then(()=>t.hide())})}}const ue=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"})),rt=Object.assign({"./dialogs/add-item.ts":Nt,"./dialogs/change-password.ts":Lt,"./dialogs/import.ts":Pt,"./dialogs/password.ts":ue}),K=Object.create(null);for(const s in rt){const t=s.match(/\/([^\/]+)\.ts$/);if(!t)continue;const e=t[1],n=rt[s].default;K[e]={class:n}}class he{constructor(t="custom-dialog",e="dialog-title",n="dialog-body",r="dialog-close"){I(this,"overlay");I(this,"title");I(this,"body");I(this,"closeBtn");this.overlay=document.getElementById(t),this.title=document.getElementById(e),this.body=document.getElementById(n),this.closeBtn=document.getElementById(r),this.closeBtn.addEventListener("click",()=>this.hide()),this.overlay.addEventListener("click",o=>{o.target===this.overlay&&this.hide()})}dataEvents(){document.querySelectorAll("[data-dialog]").forEach(t=>{t.classList.contains("dialog-activator")||(t.addEventListener("click",e=>{this.show(t.dataset.dialog)}),t.classList.add("dialog-activator"))})}show(t,e){let n;if(typeof t=="string"){if(!(t in K)){console.error(`Dialog not found: ${t}`);return}K[t].instance||(K[t].instance=new K[t].class),n=K[t].instance}else n=t;this.title.textContent=n.title,this.body.innerHTML="",typeof n.content=="string"?this.body.innerHTML=n.content:this.body.appendChild(n.content),this.overlay.style.display="flex",n.onShow(this,e)}hide(){this.overlay.style.display="none"}}async function le(s,t){const e=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",e),r=crypto.getRandomValues(new Uint8Array(12)),o={name:"AES-GCM",iv:r},i=await crypto.subtle.importKey("raw",n,o,!1,["encrypt"]),h=new TextEncoder().encode(s),u=await crypto.subtle.encrypt(o,i,h),w=Array.from(new Uint8Array(u)).map(p=>String.fromCharCode(p)).join(""),c=btoa(w);return Array.from(r).map(p=>("00"+p.toString(16)).slice(-2)).join("")+c}async function fe(s,t){const e=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",e),r=s.slice(0,24).match(/.{2}/g).map(u=>parseInt(u,16)),o={name:"AES-GCM",iv:new Uint8Array(r)},i=await crypto.subtle.importKey("raw",n,o,!1,["decrypt"]),h=atob(s.slice(24));if(h!==null){const u=new Uint8Array(h.match(/[\s\S]/g).map(c=>c.charCodeAt(0))),l=await crypto.subtle.decrypt(o,i,u);return new TextDecoder().decode(l)}return""}class we{hasData(){return!!localStorage.data}async addItem(t,e){return this.addItems([t],e)}async addItems(t,e){let n=[];return this.hasData()&&(n=await this.getData(e)),n.push(...t),this.setData(n,e)}changePassword(t,e){return this.getData(t).then(n=>this.setData(n,e))}setData(t,e){return le(JSON.stringify(t),e).then(n=>(localStorage.data=n,!0))}getData(t){return fe(localStorage.data,t).then(e=>{if(e[0]!="["){let n=atob(e);const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);const o=at(r);return console.warn("Migrating old data to new object",o),this.setData(o,t),o}return JSON.parse(e)})}}window.appStorage=new we;const ot=new he;document.addEventListener("DOMContentLoaded",()=>{ot.dataEvents(),yt("",!0).catch(s=>{ot.show("password")})});
